var IframePlayerProvider=function(){"use strict";var e=function(){return(e=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};var t={setPlay:function(){var e=this,t=this.config.$video.play();if("undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]"))t.then((function(){e.postVideoMessage({eventType:"reply-set-play",value:{resolved:!0}})})).catch((function(){e.postVideoMessage({eventType:"reply-set-play",value:{resolved:!1}})}));else{var n=this.config.$video.paused;this.postVideoMessage({eventType:"reply-set-play",value:{resolved:!n}})}},setPause:function(){this.config.$video.pause()},setMuted:function(e){e&&"muted"in e&&(this.config.$video.muted=e.muted)},setPresentationMode:function(e){e&&"presentationMode"in e&&this.config.$video.webkitSetPresentationMode(e.presentationMode)},getDuration:function(){this.postVideoMessage({eventType:"reply-get-duration",value:{seconds:this.config.$video.duration}})},getCurrentTime:function(){this.postVideoMessage({eventType:"reply-get-current-time",value:{seconds:this.config.$video.currentTime}})},getMuted:function(){this.postVideoMessage({eventType:"reply-get-muted",value:{muted:this.config.$video.muted}})},getPresentationMode:function(){this.postVideoMessage({eventType:"reply-get-presentation-mode",value:{presentationMode:this.config.$video.webkitPresentationMode}})},canPlay:function(){this.postVideoMessage({eventType:"can-play",value:null})},pause:function(){this.postVideoMessage({eventType:"pause",value:null})},play:function(){this.postVideoMessage({eventType:"play",value:null})},ended:function(){this.postVideoMessage({eventType:"ended",value:null})},timeUpdate:function(){this.postVideoMessage({eventType:"time-update",value:{currentTime:this.config.$video.currentTime}})},volumeChange:function(){this.postVideoMessage({eventType:"volume-change",value:{volume:this.config.$video.volume,muted:this.config.$video.muted}})},presentationModeChanged:function(){this.postVideoMessage({eventType:"presentation-mode-changed",value:{presentationMode:this.config.$video.webkitPresentationMode}})},error:function(e){this.postVideoMessage({eventType:"error",value:{message:e.name+": "+e.message}})}};return function(){function n(n){var o,i=this;this.config=e({},n),this.actions=e({},t),n.$video instanceof HTMLVideoElement||t.error.call(this,new TypeError("config.$video 不是 HTMLVideoElement 实例; "+Object.prototype.toString.call(n.$video)));var s=null!==(o=n.actions)&&void 0!==o?o:{};Object.keys(s).forEach((function(e){if(e in t&&"function"==typeof s[e]){var n=e;i.actions[n]=s[n]}}));var a=n.$video;["canPlay","pause","play","ended","timeUpdate","volumeChange","presentationModeChanged"].forEach((function(e){a.addEventListener(e.toLowerCase(),(function(){t[e].call(i)}))})),window.addEventListener("message",(function(e){var n=e.data;if(function(e){return n=typeof(t=e),null!=t&&("object"==n||"function"==n)&&"eventType"in e;var t,n}(n))switch(n.eventType){case"set-play":t.setPlay.call(i);break;case"set-pause":t.setPause.call(i);break;case"set-muted":t.setMuted.call(i,n.value);break;case"set-presentation-mode":t.setPresentationMode.call(i,n.value);break;case"get-duration":t.getDuration.call(i);break;case"get-current-time":t.getCurrentTime.call(i);break;case"get-muted":t.getMuted.call(i);break;case"get-presentation-mode":t.getPresentationMode.call(i)}}),!1)}return n.prototype.postVideoMessage=function(e){this.config.targetWindow.postMessage(e,"*")},n}()}();
